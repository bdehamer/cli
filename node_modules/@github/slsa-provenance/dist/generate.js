"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateProvenance = void 0;
const sigstore_1 = require("sigstore");
const handlers_1 = require("./handlers");
const INTOTO_PAYLOAD_TYPE = 'application/vnd.in-toto+json';
async function generate(subject, opts) {
    const provenance = await (0, handlers_1.generateProvenance)(subject);
    const payload = Buffer.from(JSON.stringify(provenance));
    return sigstore_1.sigstore.signAttestation(payload, INTOTO_PAYLOAD_TYPE, {
        fulcioBaseURL: opts === null || opts === void 0 ? void 0 : opts.fulcioURL,
        rekorBaseURL: opts === null || opts === void 0 ? void 0 : opts.rekorURL,
        identityToken: opts === null || opts === void 0 ? void 0 : opts.identityToken,
    });
}
exports.generateProvenance = generate;
